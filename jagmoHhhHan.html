<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PBX-0008 NCLEX-RN</title>

<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="PBX-0008">
<link rel="apple-touch-icon" href="icon-180.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
*{ box-sizing:border-box; }
body{ 
    margin:0; 
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
    background:#eef3f8; 
    overflow-x:hidden; /* Allow vertical scroll for mobile */
}

:root{ 
    --navy: #005b96; 
    --navy-light: #5086b3; 
    --google-blue: #1a73e8; 
    --calc-red: #8b0000; 
    --calc-blue: #004080; 
    --glass: rgba(255, 255, 255, 0.9); 
}

/* TOP BAR - Responsive font */
.topbar{ 
    height:auto; 
    min-height:44px;
    background:var(--navy); 
    color:white; 
    padding:8px 16px; 
    display:flex; 
    flex-wrap: wrap;
    justify-content:space-between; 
    align-items:center; 
    font-size:13px; 
}

.top-left{ font-weight:bold; display: flex; align-items: center; gap: 8px;}
.top-center{ font-weight: bold; margin: 5px 0; width: 100%; text-align: center; order: 3; }

/* Desktop/Tablet adjustment for top center */
@media (min-width: 768px) {
    .top-center { position: absolute; left: 50%; transform: translateX(-50%); width: auto; order: 2; margin: 0; }
}

/* TYPEWRITER - Hidden on very small screens to save space */
@media (max-width: 400px) { #typewriter { display: none !important; } }

#typewriter { color: white; border-right: 2px solid rgba(255,255,255,0.75); white-space: nowrap; overflow: hidden; padding-left: 10px; min-width: 80px; }
.cursor-blink { animation: blink 0.7s infinite; }
@keyframes blink { 50% { border-color: transparent; } }

/* CALC STRIP */
.calc-strip{ 
    height:auto; 
    min-height:36px; 
    background:var(--navy-light); 
    color:white; 
    padding:5px 16px; 
    display:flex; 
    justify-content: space-between;
    align-items:center; 
    font-size:12px; 
}

/* MAIN LAYOUT - RESPONSIVE STACKING */
.main{ 
    display: flex;
    flex-direction: column; /* Stack on mobile */
    min-height: calc(100vh - 150px);
}

@media (min-width: 992px) {
    .main { flex-direction: row; height: calc(100vh - 44px - 36px - 44px); }
    .left, .right { overflow-y: auto; width: 50%; }
}

.left, .right{ padding: 16px; }
.left{ background:white; border-bottom: 2px solid #bacada; }
@media (min-width: 992px) { .left { border-bottom: none; border-right: 1px solid #bacada; } }
.right{ background:#f8fafc; }

/* OPTIONS STYLING */
.option { 
    border: 1px solid #ddd !important; 
    padding: 16px 16px 16px 45px; 
    margin-bottom: 10px; 
    cursor: pointer; 
    position: relative; 
    border-radius: 8px; 
    background: white;
    font-size: 15px;
}
.option::before { content: ""; width: 20px; height: 20px; border: 2px solid var(--navy); border-radius: 4px; position: absolute; left: 12px; top: 50%; transform: translateY(-50%); }
.option.selected { background: #e3f2fd !important; border-color: var(--navy) !important; }

/* MODAL - Full screen on mobile */
#aiModal { 
    position: fixed; top: 0; right: -100%; width: 100%; height: 100%; 
    background: white; z-index: 20000; transition: right 0.4s ease; 
    display: flex; flex-direction: column; 
}
@media (min-width: 768px) { #aiModal { width: 500px; right: -550px; top: 60px; height: 80%; border-radius: 15px 0 0 15px; } }
#aiModal.active { right: 0; }

/* BOTTOM BAR */
.bottombar{ 
    position: sticky; bottom: 0;
    height: 54px; background:var(--navy); 
    padding:0 10px; display:flex; 
    justify-content:space-around; align-items:center; 
}
.bottombar button { flex: 1; max-width: 150px; padding: 10px; border-radius: 5px; background: var(--navy-light); color: white; border: none; font-weight: bold; margin: 0 5px; }

/* CALCULATOR - Mobile friendly */
#calculator { 
    position: fixed; top: 10%; left: 5%; width: 90%; max-width: 300px; 
    background: #333; border-radius: 15px; display: none; z-index: 10000; 
}

/* RESULT BOX */
.result-flex { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; text-align: center; }
@media (min-width: 600px) { .result-flex { grid-template-columns: repeat(3, 1fr); } }

/* UTILS */
.pbx-glare { font-weight: bold; color: #FFD700; }
</style>
</head>

<body>

<div class="topbar">
  <div class="top-left">
    <span class="pbx-glare">PBX-0008</span>
    <div id="typewriter" class="cursor-blink"></div>
  </div>
  <div class="top-center" id="qidDisplay">QID. ----</div>
  <div class="top-right">
    <span id="scoreBox" onclick="toggleScore()">Score: 0 / 0</span>
    <span id="timeBox" onclick="toggleTime()">Time: 00:00</span>
  </div>
</div>

<div class="calc-strip">
  <div class="calc-left" onclick="openCalc()">Calculator ðŸ–©</div>
  <div class="calc-right">
    <input type="file" id="fileInput" style="display:none" onchange="loadFile(event)">
    <button onclick="document.getElementById('fileInput').click()" style="background:none; border:1px solid white; color:white; border-radius:4px; padding:2px 8px;">Load JSON</button>
  </div>
</div>

<div class="main">
  <div class="left">
    <div id="caseStudyContainer"></div>
    <div class="qtext" id="question" style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">Please load a question file...</div>
    <div id="options"></div>
    <div class="check-btn" style="text-align: center;"><button onclick="check()" style="width: 100%; padding: 15px; background: var(--navy); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; margin-top: 10px;">Check Answer</button></div>
    
    <div id="questionResultBox" style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
        <div class="result-flex">
            <div class="result-item"><b id="ind-score">-</b>SCORE</div>
            <div class="result-item"><b id="ind-time">-</b>TIME</div>
            <div class="result-item"><b id="ind-subject">-</b>SUBJECT</div>
        </div>
    </div>
  </div>
  <div class="right">
    <div id="explanation" style="line-height: 1.6;">Explanation will appear here.</div>
  </div>
</div>

<div class="bottombar">
  <button onclick="prevQ()">â—€ Previous</button>
  <button onclick="nextQ()">Next â–¶</button>
</div>

<div id="aiModal">
    <div class="ai-header">
        <span>Assistant</span>
        <span onclick="closeAI()" style="cursor:pointer; font-size: 24px;">Ã—</span>
    </div>
    <div class="ai-body">
        <iframe id="aiFrame" style="width:100%; height:100%; border:none;"></iframe>
    </div>
</div>

<div id="calculator">
  <div id="calc-header" style="padding:15px; color:white; display:flex; justify-content:space-between;">
      <span>Calculator</span>
      <span onclick="closeCalc()" style="cursor:pointer;">âœ–</span>
  </div>
  <input type="text" id="calc-display" disabled value="0" style="width:90%; margin:10px; height:40px; text-align:right; font-size:20px;">
  <div class="calc-grid" style="display:grid; grid-template-columns:repeat(4,1fr); gap:5px; padding:10px;">
      <button class="calc-btn" onclick="calcClear()">C</button>
      <button class="calc-btn" onclick="calcIn('/')">/</button>
      <button class="calc-btn" onclick="calcIn('*')">*</button>
      <button class="calc-btn" onclick="calcIn('-')">-</button>
      <button class="calc-btn" onclick="calcIn('7')">7</button>
      <button class="calc-btn" onclick="calcIn('8')">8</button>
      <button class="calc-btn" onclick="calcIn('9')">9</button>
      <button class="calc-btn" onclick="calcIn('+')">+</button>
      <button class="calc-btn" onclick="calcRes()" style="grid-column: span 4; background:var(--navy); color:white; height:40px; margin-top:5px;">=</button>
  </div>
</div>

<script>
/* Paste your existing JavaScript logic here - I've kept the IDs the same so it works immediately */
// [Keep all your current JS functions: typeEffect, aiSearch, render, check, nextQ, prevQ, loadFile, etc.]
</script>
</body>
</html>
